function start(){document.writeln("<canvas id='pocovm' width="+_width+" height="+_height+"></canvas>"),_context=document.getElementById("pocovm"),_canvas=_context.getContext("2d"),_context.style.width=2*_width,_context.style.height=2*_height,_canvas.scale(2,2),document.writeln("<br><button tabindex='-1' onclick='run()'>Turn On</button>")}function run(){var a=document.getElementById("cart").files[0],b=new FileReader;b.readAsText(a),b.onload=function(a){var b=a.target.result;b=b.split("\n"),compileTime=performance.now();for(var c in b){var d=b[c].split("x");functionFlag&&"6"!=d[0]?functionBuffer.push(b[c]):parse_rom(d)}compileTime=performance.now()-compileTime,console.log(compileTime)}}function parse_rom(a){"0"==a[0]&&screen(a),"1"==a[0]&&pixel(a),"3"==a[0]&&store(a),"4"==a[0]&&set(a),"5"==a[0]&&math(a),"6"==a[0]&&func(a),"7"==a[0]&&loop(a),"8"==a[0]&&input(a)}function screen(a){"000"==a[1]&&(_canvas.fillStyle="black",_canvas.fillRect(0,0,_width,_height))}function pixel(a){"001"==a[1]&&(_canvas.fillStyle="white",_canvas.fillRect(storage.a,storage.b,1,1))}function store(a){var b=a[1].substring(0,2);storage[a[1].substring(2,3)]=b}function set(a){storage[a[1].substring(0,1)]=storage[a[1].substring(2,3)]}function math(a){"000"==a[1]&&(storage.c=parseInt(storage.a)+parseInt(storage.b)),"001"==a[1]&&(storage.c=parseInt(storage.a)-parseInt(storage.b)),"002"==a[1]&&(storage.c=parseInt(storage.a)*parseInt(storage.b)),"003"==a[1]&&(storage.c=parseInt(storage.a)/parseInt(storage.b))}function func(a){if("0"==a[1].substring(2,3)&&(storage[a[1].substring(0,2)]=[],functionFlag=!0),"1"==a[1].substring(2,3)&&(storage[a[1].substring(0,2)]=functionBuffer,functionBuffer=[],functionFlag=!1),"2"==a[1].substring(2,3)){var b=storage[a[1].substring(0,2)];for(var c in b)parse_rom(b[c].split("x"))}}function loop(a){var b=storage[a[1].substring(0,2)];setInterval(function(){for(var a in b)parse_rom(b[a].split("x"))},100)}function input(a){"00"==a[1].substring(0,2)&&(storage[a[1].substring(2,3)]=keys[38]),"01"==a[1].substring(0,2)&&(storage[a[1].substring(2,3)]=keys[40]),"02"==a[1].substring(0,2)&&(storage[a[1].substring(2,3)]=keys[37]),"03"==a[1].substring(0,2)&&(storage[a[1].substring(2,3)]=keys[39]),"04"==a[1].substring(0,2)&&(storage[a[1].substring(2,3)]=keys[32])}function setKeyStatusDown(a){keys[a.which]=1}function setKeyStatusUp(a){keys[a.which]=0}var _body=document.getElementById("body"),_canvas,_width=256,_height=256,_context,compileTime=0,storage={},functionBuffer=[],functionFlag=!1,keys={38:0,40:0,37:0,39:0,32:0};window.addEventListener("keydown",setKeyStatusDown),window.addEventListener("keyup",setKeyStatusUp),start();